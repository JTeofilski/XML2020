<!DOCTYPE html>
<html>
	<head>
	<script src="scripts/jquery-3.2.1.min.js"></script>
		<script src="scripts/tether.min.js"></script>
		<script src="scripts/bootstrap.min.js"></script>
		<script src="scripts/fje.js"></script>
		<script src="js/oglas.js" type="text/javascript"></script>
		<style>
			table, th, td {
  				border: 1px solid black;
			}
			body {	
				background: linear-gradient(45deg, #fafbfc, #00FFFF);
			}

			.container{
				position: relative;
				left: 10%;
				
			}
			button{
			border: 1px solid black;
			position: relative;
			   }
			   form{
			   position: relative;
				
			   }
			
		</style>
		
		<meta charset="UTF-8">
		<title>Spisak oglasa</title>
		<script>
		$(document).ready(function() {
			 $.ajax({
			        url: "http://localhost:2020/pretragaapp/oglasi/sviOglasi", 
			   		type: "GET",
			   		contentType: "application/json",
			   		datatype: 'json',
			    	   success: function(data){	   
			    		  for (var i=0; i<data.length; i++){
			    		   newRow = 
									"<tr>"
										+ "<td>" + "<a id='link' href='#' onclick='Fja("+data[i].identifikacioniBroj+")'>" + data[i].identifikacioniBroj+"</a>"+"</td>"
										+ "<td>" + data[i].vozilo.identifikacioniBroj + "</td>"
										+ "<td>" + data[i].vozilo.klasaVozila + "</td>"
										+ "<td>" + data[i].vozilo.nazivKlase + "</td>"
										+ "<td>" + data[i].voziloSlobodnoOd + "</td>"
										+ "<td>" + data[i].voziloSlobodnoDo + "</td>"
										+ "<td>" + data[i].agent.ime + "</td>"
										+ "<td>" + " <button onclick='Korpafja("+data[i].identifikacioniBroj+")'>Korpa</button>" + " </td>"
											
									+ "</tr>"
									
								$("#oglas").append(newRow)						
			    	   }
			    	   }
			      
			       });
			 $("#pretraga").click(function() {
		  		 var adresa = document.getElementById("adresa").value;
		  		 var voziloSlobodnoOd = document.getElementById("datumOd").value;
		  		var voziloSlobodnoDo = document.getElementById("datumDo").value;
		  		
		  		$.ajax({
					url: "http://localhost:2020/pretragaapp/oglasi/pretraga/" + adresa + "/" + voziloSlobodnoOd + "/" + voziloSlobodnoDo
		  		}).then(function(data) {	
		  			$("#oglas").empty();
		  			for(i=0; i<data.length; i++){
		  			/*	if(data.length<0){
		  					 $("#oglas").empty();
								newRow = "<tr>"
									+ "<td class=\"name\">" + "0 rezultata trazene pretrage" + "</td>"
									+ "</tr>"
								$("#oglas").append(newRow)
		  				}*/
					 if(data[i].agent.adresa){
						 
						 newRow = 
								"<tr>"
									+ "<td>" + "<a id='link' href='#' onclick='Fja("+data[i].identifikacioniBroj+")'>" + data[i].identifikacioniBroj+"</a>"+"</td>"
									+ "<td>" + data[i].vozilo.identifikacioniBroj + "</td>"
									+ "<td>" + data[i].vozilo.klasaVozila + "</td>"
									+ "<td>" + data[i].vozilo.nazivKlase + "</td>"
									+ "<td>" + data[i].agent.ime + "</td>"
									
								+ "</tr>"
								
							$("#oglas").append(newRow)		
						
					 }
		  			}
					});
					
				});
			 $("#naprednaPretraga").click(function() {
				 var adresa = document.getElementById("adresa").value;
		  		 var voziloSlobodnoOd = document.getElementById("datumOd").value;
		  		var voziloSlobodnoDo = document.getElementById("datumDo").value;
		  		 var nazivMarke = document.getElementById("marka").value;
		  		 var nazivModela = document.getElementById("model").value;
		  		var nazivVrsteGoriva = document.getElementById("gorivo").value;
		  		
		  		$.ajax({
					url: "http://localhost:2020/pretragaapp/oglasi/naprednaPretraga/" + adresa + "/" + voziloSlobodnoOd+ "/" + voziloSlobodnoDo+ "/" + nazivMarke + "/" + nazivModela + "/" + nazivVrsteGoriva
		  		}).then(function(data) {	
		  			$("#oglas").empty();
		  			for(i=0; i<data.length; i++){
		  			/*	if(data.length<0){
		  					 $("#oglas").empty();
								newRow = "<tr>"
									+ "<td class=\"name\">" + "0 rezultata trazene pretrage" + "</td>"
									+ "</tr>"
								$("#oglas").append(newRow)
		  				}*/
					
						 
						 newRow = 
								"<tr>"
									+ "<td>" + "<a id='link' href='#' onclick='Fja("+data[i].identifikacioniBroj+")'>" + data[i].identifikacioniBroj+"</a>"+"</td>"
									+ "<td>" + data[i].vozilo.identifikacioniBroj + "</td>"
									+ "<td>" + data[i].vozilo.klasaVozila + "</td>"
									+ "<td>" + data[i].vozilo.nazivKlase + "</td>"
									+ "<td>" + data[i].vozilo.nazivMarke + "</td>"
									+ "<td>" + data[i].vozilo.nazivModela + "</td>"
									+ "<td>" + data[i].vozilo.nazivVrsteGoriva + "</td>"
									+ "<td>" + data[i].vozilo.slika + "</td>"
									+ "<td>" + data[i].agent.ime + "</td>"
									
								+ "</tr>"
								
							$("#oglas").append(newRow)		
						
					 
		  			}
					});
					
				});
		  
			 });
			
		</script>
		<script>
function goBack() {
  //window.location.href="http://localhost:2020/pretragaapp/oglasi.html"
}
</script>
	</head>
	<body>
		<h3 id="oglasNaslov">Spisak oglasa</h3>
		
		<table id="oglas" class = "table " style= "width:700px">
			<tr class="header">
				<th>id oglasa</th>
				<th>id vozila</th>
				<th>klasa vozila</th>
				<th>naziv klase</th>
				<th>vozilo slobodno od</th>
				<th>vozilo slobodno do</th>
				<th>ime agenta</th>
				
			</tr>
			</table>
			
			<form id="pretragaForma" style= "width:700px" class= "pretraga">
		 <div class="container">
		<input type="text" class="form-control" id="adresa" name="adresa" placeholder = "Unesite mesto sa kog zelite preuzeti vozilo">
		<input type="date" class="form-control" id="datumOd" name="datumOd" placeholder = "Unesite datum preuzimanja format:yyyy-MM-dd">
		<input type="date" class="form-control" id="datumDo" name="datumDo" placeholder = "Unesite datum vracanja vozila format:yyyy-MM-dd">
		<button type="button" id="pretraga">pretraga</button>
	
					<p id="greskaLogovanje"></p>
				
		</div>
		</form>
		<form id="naprednaPretraga" style= "width:700px" class= "pretraga">
		 <div class="container">
		<input type="text" class="form-control" id="marka" name="marka" placeholder = "Unesite marku vozila">
		<input type="text" class="form-control" id="model" name="model" placeholder = "Unesite model vozila">
		<input type="text" class="form-control" id="gorivo" name="gorivo" placeholder = "Unesite vrstu goriva">
		<button type="button" id="naprednaPretraga">napredna pretraga</button>
		</div>
		</form>
		<button onclick="goBack()">Go Back</button>
	</body>
</html>