<!DOCTYPE html>
<html>
	<head>
	<script src="scripts/jquery-3.2.1.min.js"></script>
		<script src="scripts/tether.min.js"></script>
		<script src="scripts/bootstrap.min.js"></script>
		<script src="scripts/fje.js"></script>
		<script src="js/oglas.js" type="text/javascript"></script>
		<style>
			table, th, td {
  				border: 1px solid black;
			}
			body {	
				background: linear-gradient(45deg, #fafbfc, #00FFFF);
			}

			.container{
				position: relative;
				left: 10%;
				
			}
			button{
			border: 1px solid black;
			position: relative;
			   }
			   form{
			   position: relative;
				
			   }
			 #sort{
  display:none;
}
		</style>
		
		<meta charset="UTF-8">
		<title>Spisak oglasa</title>
		<script>
		var params = window.location.search.split('?')[1];
		var korid =  params.split('=')[1];
		var data1;
		$(document).ready(function() {
			 $.ajax({
			        url: "http://localhost:2020/pretragaapp/oglasi/sviOglasi", 
			   		type: "GET",
			   		contentType: "application/json",
			   		datatype: 'json',
			    	   success: function(data){	   
			    		  for (var i=0; i<data.length; i++){
			    			  var temp = data[i].vozilo.slike
				    		   var slike= temp.split(';')
				    		 
				    			   	//$("#slika").append("<img height='100' width='150' src='"+slike[0]+"'>")
			    		   newRow = 
									"<tr>"
										+ "<td>" + "<a id='link' href='#' onclick='Fja("+data[i].identifikacioniBroj+")'>" + data[i].identifikacioniBroj+"</a>"+"</td>"
										+ "<td>" + data[i].vozilo.identifikacioniBroj + "</td>"
										+ "<td>" + data[i].vozilo.klasaVozila + "</td>"
										+ "<td>" + data[i].vozilo.nazivKlase + "</td>"
										+ "<td>" + data[i].voziloSlobodnoOd + "</td>"
										+ "<td>" + data[i].voziloSlobodnoDo + "</td>"
										+ "<td>" + "<img height='100' width='150' src='"+slike[0]+"'>" + "</td>"
										+ "<td>" + " <button onclick='Korpafja("+data[i].identifikacioniBroj+","+korid+")'>Korpa</button>" + " </td>"
											
									+ "</tr>"
									
								$("#oglas").append(newRow)	
								getData()
			    	   }
			    	   }
			      
			       });
			 $("#pretraga").click(function() {
		  		 var adresa = document.getElementById("adresa").value;
		  		 var voziloSlobodnoOd = document.getElementById("datumOd").value;
		  		var voziloSlobodnoDo = document.getElementById("datumDo").value;
		  		
		  		
		  		$.ajax({
					url: "http://localhost:2020/pretragaapp/oglasi/pretraga/" + adresa + "/" + voziloSlobodnoOd + "/" + voziloSlobodnoDo
		  		}).then(function(data) {
		  			data1  = data;
		  			console.log(data1[0].identifikacioniBroj);
		  			$("#oglas").empty();
		  			for(i=0; i<data.length; i++){
		  			/*	if(data.length<0){
		  					 $("#oglas").empty();
								newRow = "<tr>"
									+ "<td class=\"name\">" + "0 rezultata trazene pretrage" + "</td>"
									+ "</tr>"
								$("#oglas").append(newRow)
		  				}*/
		  				var temp = data[i].vozilo.slike
			    		   var slike= temp.split(';')
			    		   
					 if(data[i].agent.adresa){
						 
						 newRow = 
								"<tr>"
									+ "<td>" + "<a id='link' href='#' onclick='Fja("+data[i].identifikacioniBroj+")'>" + data[i].identifikacioniBroj+"</a>"+"</td>"
									+ "<td>" + data[i].vozilo.identifikacioniBroj + "</td>"
									+ "<td>" + data[i].vozilo.klasaVozila + "</td>"
									+ "<td>" + data[i].vozilo.nazivKlase + "</td>"
									+ "<td>" + "<img height='100' width='150' src='"+slike[0]+"'>" + "</td>"
									+ "<td>" + data[i].agent.ime + "</td>"
									
								+ "</tr>"
								
							$("#oglas").append(newRow)		
					document.getElementById("sort").style.display="grid";
					 }
		  			}
					});
					
				});
			 $('#sort').on('change', function() {               
		            if ($("#sort").val() != "") { 
		            	var kriterijum = $(this).val();
		            	alert(kriterijum)
		                $.ajax({
		                	url: "http://localhost:2020/pretragaapp/oglasi/sortiranje/" + kriterijum,
		                    type: 'GET',
		                    success: function (data){                      
		                    	 for (var i=0; i<data.length; i++){
					    			  var temp = data[i].vozilo.slike
						    		   var slike= temp.split(';')
						    		 
						    			   	//$("#slika").append("<img height='100' width='150' src='"+slike[0]+"'>")
					    		   newRow = 
											"<tr>"
												+ "<td>" + "<a id='link' href='#' onclick='Fja("+data[i].identifikacioniBroj+")'>" + data[i].identifikacioniBroj+"</a>"+"</td>"
												+ "<td>" + data[i].vozilo.identifikacioniBroj + "</td>"
												+ "<td>" + data[i].vozilo.klasaVozila + "</td>"
												+ "<td>" + data[i].vozilo.nazivKlase + "</td>"
												+ "<td>" + data[i].voziloSlobodnoOd + "</td>"
												+ "<td>" + data[i].voziloSlobodnoDo + "</td>"
												+ "<td>" + "<img height='100' width='150' src='"+slike[0]+"'>" + "</td>"
												+ "<td>" + " <button onclick='Korpafja("+data[i].identifikacioniBroj+","+korid+")'>Korpa</button>" + " </td>"
													
											+ "</tr>"
											
										$("#oglas").append(newRow)	
										getData()
					    	   }
					    	   }
		                });
		            }

		        });
			 $("#naprednaPretraga").click(function() {
				 var adresa = document.getElementById("adresa").value;
		  		 var voziloSlobodnoOd = document.getElementById("datumOd").value;
		  		var voziloSlobodnoDo = document.getElementById("datumDo").value;
		  		 var nazivMarke = document.getElementById("marka").value;
		  		 var nazivModela = document.getElementById("model").value;
		  		var nazivVrsteGoriva = document.getElementById("gorivo").value;
		  		var nazivKlase = document.getElementById("klasa").value;
		  		var nazivTipaMenjaca = document.getElementById("menjac").value;
		  		var brojSedistaZaDecu = document.getElementById("sedista").value;
		  		var predjenaKilometraza = document.getElementById("predjenaKilometraza").value;
		  		var predjenaKilometraza = document.getElementById("predjenaKilometraza").value;
		  		var ogranicenjeKilometraze = document.getElementById("ogranicenjeKilometraze").value;
		  		//console.log(data1[0]);
		  		if(document.getElementById("da").checked==true){
		  			
		  			var collisiondamageWaiver = true;
		  		}else{
		  			var collisiondamageWaiver = false;
		  			
		  		}
		  		
		  		$.ajax({
					url: "http://localhost:2020/pretragaapp/oglasi/naprednaPretraga/" + adresa + "/" + voziloSlobodnoOd+ "/" + voziloSlobodnoDo+ "/" + nazivMarke + "/" + nazivModela + "/" + nazivVrsteGoriva + "/" + nazivKlase + "/" + nazivTipaMenjaca + "/" + brojSedistaZaDecu + "/" + predjenaKilometraza + "/" + collisiondamageWaiver + "/" + ogranicenjeKilometraze
		  		}).then(function(data) {	
		  			$("#oglas").empty();
		  			for(i=0; i<data.length; i++){
		  			/*	if(data.length<0){
		  					 $("#oglas").empty();
								newRow = "<tr>"
									+ "<td class=\"name\">" + "0 rezultata trazene pretrage" + "</td>"
									+ "</tr>"
								$("#oglas").append(newRow)
		  				}*/
		  				
		  				var temp = data[i].vozilo.slike
			    		   var slike= temp.split(';')
						 
						 newRow = 
								"<tr>"
									+ "<td>" + "<a id='link' href='#' onclick='Fja("+data[i].identifikacioniBroj+")'>" + data[i].identifikacioniBroj+"</a>"+"</td>"
									+ "<td>" + data[i].vozilo.identifikacioniBroj + "</td>"
									+ "<td>" + data[i].vozilo.klasaVozila + "</td>"
									+ "<td>" + data[i].vozilo.nazivKlase + "</td>"
									+ "<td>" + data[i].vozilo.nazivMarke + "</td>"
									+ "<td>" + data[i].vozilo.nazivModela + "</td>"
									+ "<td>" + data[i].vozilo.nazivVrsteGoriva + "</td>"
									+ "<td>" + "<img height='100' width='150' src='"+slike[0]+"'>" + "</td>"
									+ "<td>" + data[i].agent.ime + "</td>"
									
									
								+ "</tr>"
								
							$("#oglas").append(newRow)		
						
					 
		  			}
					});
					
				});
		  
			 });
			
		</script>
		<script>
		function getData() {

			 var oTable = document.getElementById('oglas');

			    //gets rows of table
			    var rowLength = oTable.rows.length;

			    //loops through rows    
			    for (i = 1; i < rowLength; i++){

			      //gets cells of current row  
			       var oCells = oTable.rows.item(i).cells;

			       //gets amount of cells of current row
			       var cellLength = oCells.length;

			       //loops through each cell in current row
			    }

			              // get your cell info here

			              var cellVal = oCells.item(1).innerHTML;
			              console.log(cellVal);
			           
			   
		 }

		 function printData(data) {
		     for (i = 0; i < data.length; i++) {
		         for (k = 0; k < data[i].items.length; k++) {
		             console.log(data[i].items[k].inputValue);
		         }
		     }
		 }
</script>
		<script>
function Link(){
	window.location.href = "http://localhost:2020/pretragaapp/korpa.html?id="+0+"&korid="+korid;

}
		
function goBack() {
  //window.location.href="http://localhost:2020/pretragaapp/oglasi.html"
}


</script>
<style>
a:hover {
  color: red;
}
</style>
	</head>
	<body>
		<h3 id="oglasNaslov">Spisak oglasa</h3>
		<a href="#" onclick=Link()>Korpa</a>
		<table id="oglas" class = "table " style= "width:700px">
			<tr class="header">
				<th>id oglasa</th>
				<th>id vozila</th>
				<th>klasa vozila</th>
				<th>naziv klase</th>
				<th>vozilo slobodno od</th>
				<th>vozilo slobodno do</th>
				<th id="slika">slike</th>
				<th>ime agenta</th>
				
			</tr>
			</table>
			<label for="sort">sortiranje po:</label>

<select name="sort" id="sort">
<option value="e"></option>
  <option value="predjenaKilometraza">kilometrazi</option>
  <option value="cena">ceni</option>
  <option value="ocena">oceni</option>
</select>
			<form id="pretragaForma" style= "width:700px" class= "pretraga">
		 <div class="container">
		<input type="text" class="form-control" id="adresa" name="adresa" placeholder = "Unesite mesto sa kog zelite preuzeti vozilo">
		<input type="date" class="form-control" id="datumOd" name="datumOd" placeholder = "Unesite datum preuzimanja format:yyyy-MM-dd">
		<input type="date" class="form-control" id="datumDo" name="datumDo" placeholder = "Unesite datum vracanja vozila format:yyyy-MM-dd">
		<button type="button" id="pretraga">pretraga</button>
	
					<p id="greskaLogovanje"></p>
				
		</div>
		</form>
		<form id="naprednaPretraga" style= "width:700px" class= "pretraga">
		 <div class="container">
		<input type="text" class="form-control" id="marka" name="marka" placeholder = "Unesite marku vozila">
		<input type="text" class="form-control" id="model" name="model" placeholder = "Unesite model vozila">
		<input type="text" class="form-control" id="gorivo" name="gorivo" placeholder = "Unesite vrstu goriva">
		<input type="text" class="form-control" id="klasa" name="klasa" placeholder = "Unesite klasu vozila">
		<input type="text" class="form-control" id="menjac" name="menjac" placeholder = "Unesite tip menjaca">
		<input type="text" class="form-control" id="sedista" name="sedista" placeholder = "Unesite broj sedista za decu">
		<input type="text" class="form-control" id="predjenaKilometraza" name="predjenaKilometraza" placeholder = "Unesite predjenu kilometrazu">
		<input type="text" class="form-control" id="ogranicenjeKilometraze" name="ogranicenjeKilometraze" placeholder = "Unesite planiranu kilometrazu"><br>
		<label>Collision Damage Waiver</label>
		<input type="radio" name="colors" id="da">da
        <input type="radio" name="colors" id="ne">ne<br>
		<button type="button" id="naprednaPretraga">napredna pretraga</button>
		</div>
		</form>
		<button onclick="goBack()">Go Back</button>
  

	</body>
</html>